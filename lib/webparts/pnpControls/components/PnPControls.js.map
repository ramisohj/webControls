{"version":3,"sources":["webparts/pnpControls/components/PnPControls.tsx"],"names":[],"mappings":"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","file":"webparts/pnpControls/components/PnPControls.js","sourcesContent":["import * as React from 'react';\nimport { IPnPControlsProps, IPnpControlsState } from './IPnPControlsProps';\nimport { SPHttpClient } from '@microsoft/sp-http';\n\nimport { ClientSideWebpart } from \"@pnp/sp\";\nimport { \n  sp,\n  ClientSidePage,\n} from \"@pnp/sp\";\n\nexport default class PnPControls extends React.Component<IPnPControlsProps, IPnpControlsState> {\n\n  /**\n   * Constructor\n   * @param props\n   */\n  constructor(props: IPnPControlsProps) {\n    super(props);\n\n    this.state = {\n      webParts: [], //WebPart List\n      components: [], //Component List\n      urlPage: this._getLinkPage(),  //  --> \"http://ws19-sp19-sql17:1000/sites/modern/SitePages/Home.aspx\"\n      titlePage: this._getTitlePage(), // --> \"modern\"\n      idera: false, \n      siteHome: '/sites/'+this._getTitlePage()+'/SitePages/Home.aspx' // --> \"/sites/modern/SitePages/Home.aspx\"\n    }\n  }\n\n  /**\n   * componentDidMount lifecycle hook\n   */\n  public componentDidMount() {\n      this._main();\n  }\n   \n  /**\n   * main method\n   */\n  private async _main(){\n    await this._deepControlSearch();\n    await this._idera();\n  }\n\n  /**\n   * get full url page\n   */\n  private _getLinkPage(){\n    let linkPage = this.props.context.pageContext.web.absoluteUrl;\n    return linkPage+'/SitePages/Home.aspx';\n  }\n\n  /**\n   * get title page\n   */\n  private  _getTitlePage(){\n    return this.props.context.pageContext.web.title;\n  }\n  \n  /**\n   * getting the 'idera' parameter from the url link 'http://ws19-sp19-sql17:1000/sites/modern/SitePages/Home.aspx?idera=true'\n   * if idera=true then show the list \n   * if idera=false  show nothing.\n   */\n  private _idera(){\n    var completeURL = new URLSearchParams(location.search);\n    let hasIdera = completeURL.has('idera');\n    if (hasIdera){\n      let valueIdera = completeURL.get('idera');\n      if(valueIdera === 'true'){\n        this.setState({\n          idera: true\n        });\n      }\n    }\n  }\n\n  /**\n   * method in order to search all the controllers in the page, saving them one by one.\n   * so far there are two types of components saved (webparts and webcomponents)\n   */\n  private async _deepControlSearch(){   \n\n    const file = sp.web.getFileByServerRelativePath(this.state.siteHome); //ASPX FILE\n    const page = await ClientSidePage.fromFile(file); //CLIENT SIDE PAGE\n    let partDefs = await sp.web.getClientSideWebParts();//CLIENT SIDE PAGE COMPONENT []  \n\n    page.sections.forEach(section => {//SECTIONS\n      let canvasColumn = section.columns;//COLUMNS\n      canvasColumn.forEach(column => {\n        let controls = column.controls;//CONTROLS        \n        controls.forEach(control => {      \n          let webPart = control as ClientSideWebpart;//EACH  CONTROL IS A WEB-PART \n          this.setState({ \n            webParts: [...this.state.webParts, webPart] \n          });\n        });\n       });\n    });\n\n    partDefs.forEach(webPart => {//Searching component by component\n      this.setState({\n        components: [...this.state.components, webPart]\n      });\n    });\n  }  \n\n  /**\n   * method in order to show all the controllers founded in the page.{webparts and webcomponents}\n   */\n  public loadingControllers(){\n    const webParts = this.state.webParts.map(wp => \n      <div key={wp.id}> \n        <h3> {wp.title} </h3> \n        <p> WebPartID: {wp.webPartId} </p>\n        <p> Description: {wp.description} </p>\n      </div>\n    );\n\n    const components = this.state.components.map(cp =>\n      <div key={cp.id}> \n        <h3> {cp.Name} </h3> \n        <p> Id: {cp.Id} </p>\n        <p> Status: {cp.Status} </p>\n      </div> \n    );\n\n    if(this.state.idera){\n      return (\n        <div>\n          <h2> WEB PARTS </h2>\n            <h3>number # {webParts.length} [webParts]</h3>\n            {webParts}\n          <h2> COMPONENTS </h2>\n            <h3>number # {components.length} [components]</h3>\n            {components}\n        </div>\n      )\n    }\n  }\n\n  /**\n   * React render method\n   */\n  public render(): React.ReactElement<IPnPControlsProps> {\n    return(\n      <div>\n        <h2>TITLE: {this.state.titlePage}</h2>\n        <h2>URL : {this.state.urlPage}</h2>\n        { this.loadingControllers() }\n      </div>\n    );\n  }\n}\n"],"sourceRoot":"..\\..\\..\\..\\src"}